<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOTA FISCAL</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
</head>

<body>
    <div class="container">
        <div class="header">
            <div class="header-esquerda">
                <h2><strong>PREFEITURA DO MUNICÍPIO DE SÃO PAULO</strong></h2>
                <h3>NOTA FISCAL DE SERVIÇOS ELETRÔNICA - NF-e</h3>
            </div>
            <div class="header-direita">
                <p>Número da Nota</p>
                <p id="numeroNota">000000000</p>
                <hr>
                <p>Data e Hora de Emissão</p>
                <p id="dataHora"></p>
                <hr>
                <p>Código de Verificação</p>
                <p id="codigoVerificacao"></p>
            </div>
        </div>

        <hr>

        <div class="info">
            <h2><strong>PRESTADOR DE SERVIÇOS</strong></h2>
            <p>CNPJ: <strong>12.345.678/0001-99</strong></p>
            <p>Nome/Razão Social: <strong>TechMaster Solutions</strong></p>
            <p>Endereço: <strong>Rua Inovação, 123 - São Paulo/SP</strong></p>
            <p>Município: <strong>São Paulo</strong></p>
        </div>

        <hr>

        <div class="info">
            <h2><strong>TOMADOR DE SERVIÇOS</strong></h2>
            <p>CPF/CNPJ: <input type="text" id="cpfcnpj" placeholder="000.000.000-00" required></p>
            <p>Nome/Razão Social: <input type="text" id="nomeTomador" placeholder="Nome do Cliente/Empresa" required>
            </p>
            <p>Endereço: <input type="text" id="enderecoTomador" placeholder="Endereço completo" required></p>
            <p>Município: <input type="text" id="municipioTomador" placeholder="Município" required></p>
        </div>

        <hr>

        <div class="info">
            <h2><strong>DISCRIMINAÇÃO DOS SERVIÇOS</strong></h2>
            <table class="tabela-servicos">
                <thead>
                    <tr>
                        <th>Descrição</th>
                        <th>Quantidade</th>
                        <th>Valor Unitário (R$)</th>
                        <th>Observações</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" id="campo1" required></td>
                        <td><input type="number" id="campo2" required></td>
                        <td><input type="text" id="campo3" required></td>
                        <td><input type="text" id="campo4"></td>
                    </tr>
                     <tr>
                        <td><input type="text" id="campo1" required></td>
                        <td><input type="number" id="campo2" required></td>
                        <td><input type="text" id="campo3" required></td>
                        <td><input type="text" id="campo4"></td>
                    </tr>
                     <tr>
                        <td><input type="text" id="campo1" required></td>
                        <td><input type="number" id="campo2" required></td>
                        <td><input type="text" id="campo3" required></td>
                        <td><input type="text" id="campo4"></td>
                    </tr>
                     <tr>
                        <td><input type="text" id="campo1" required></td>
                        <td><input type="number" id="campo2" required></td>
                        <td><input type="text" id="campo3" required></td>
                        <td><input type="text" id="campo4"></td>
                    </tr>
                     <tr>
                        <td><input type="text" id="campo1" required></td>
                        <td><input type="number" id="campo2" required></td>
                        <td><input type="text" id="campo3" required></td>
                        <td><input type="text" id="campo4"></td>
                    </tr>
                     <tr>
                        <td><input type="text" id="campo1" required></td>
                        <td><input type="number" id="campo2" required></td>
                        <td><input type="text" id="campo3" required></td>
                        <td><input type="text" id="campo4"></td>
                    </tr>
                     <tr>
                        <td><input type="text" id="campo1" required></td>
                        <td><input type="number" id="campo2" required></td>
                        <td><input type="text" id="campo3" required></td>
                        <td><input type="text" id="campo4"></td>
                    </tr>
                     <tr>
                        <td><input type="text" id="campo1" required></td>
                        <td><input type="number" id="campo2" required></td>
                        <td><input type="text" id="campo3" required></td>
                        <td><input type="text" id="campo4"></td>
                    </tr>
                </tbody>
            </table>
        </div>


        <button onclick="gerar()">Gerar Relatório</button>
        <button onclick="gerar(true)">Gerar PDF</button>
        <button onclick="gerar(false, true)">Imprimir</button>

        <div id="relatorio">
            <h2><strong>===NOTA FISCAL DE SERVIÇOS ELETRÔNICA===</strong></h2>
            <div class="header">
                <div class="header-esquerda">
                    <h3><strong>PREFEITURA DO MUNICÍPIO DE SÃO PAULO</strong></h3>
                    <h4>NOTA FISCAL DE SERVIÇOS ELETRÔNICA - NF-e</h4>
                </div>
                <div class="header-direita">
                    <p>Número da Nota</p>
                    <p id="relatorioNumero">000000000</p>
                    <hr>
                    <p>Data e Hora de Emissão</p>
                    <p id="relatorioData"></p>
                    <hr>
                    <p>Código de Verificação</p>
                    <p id="relatorioVerificacao"></p>
                </div>
            </div>
            <hr>
            <h3>PRESTADOR</h3>
            <p>TechMaster Solutions - CNPJ: 12.345.678/0001-99</p>
            <p>Rua Inovação, 123 - São Paulo/SP</p>
            <hr>
            <h3>TOMADOR</h3>
            <p><strong>CPF/CNPJ:</strong> <span id="relatorioCPFCNPJ"></span></p>
            <p><strong>Nome/Razão Social:</strong> <span id="relatorioNomeTomador"></span></p>
            <p><strong>Endereço:</strong> <span id="relatorioEnderecoTomador"></span></p>
            <p><strong>Município:</strong> <span id="relatorioMunicipioTomador"></span></p>
            <hr>
            <h3>DISCRIMINAÇÃO DOS SERVIÇOS</h3>
            <p><strong>Descrição:</strong> <span id="relatorio1"></span></p>
            <p><strong>Quantidade/Unidade:</strong> <span id="relatorio2"></span></p>
            <p><strong>Valor unitário:</strong> <span id="relatorio3"></span></p>
            <p><strong>Observações:</strong> <span id="relatorio4"></span></p>
            <hr>
            <h3>VALOR TOTAL DA NOTA</h3>
            <p id="valorTotal">R$ 0,00</p>

            <div style="margin-top: 40px;">
                <p>______________________________</p>
                <p>Assinatura do Solicitante</p>

                <p style="margin-top: 30px;">______________________________</p>
                <p>Assinatura do Aprovador</p>
            </div>

            <div style="margin-top: 50px; font-size: 12px; text-align: center;">
                <p>Este documento é uma simulação e não possui valor fiscal.</p>
            </div>
        </div>
    </div>

    <script>
        // Gerar número da nota
        document.addEventListener('DOMContentLoaded', function () {

            const numeroNota = Math.floor(100000000 + Math.random() * 900000000);
            document.getElementById('numeroNota').textContent = numeroNota;

            // Data e hora atual
            const agora = new Date();
            const dataFormatada = agora.toLocaleDateString('pt-BR');
            const horaFormatada = agora.toLocaleTimeString('pt-BR');
            document.getElementById('dataHora').textContent = `${dataFormatada} ${horaFormatada}`;

            // Gerar código de verificação
            const caracteres = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let codigo = '';
            for (let i = 0; i < 8; i++) {
                codigo += caracteres.charAt(Math.floor(Math.random() * caracteres.length));
            }
            document.getElementById('codigoVerificacao').textContent = codigo;
        });

        function gerar(pdf = false, print = false) {
            // Transferir dados dos campos para o relatório
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`relatorio${i}`).textContent = document.getElementById(`campo${i}`).value;
            }

            // Preencher dados do tomador no relatório
            document.getElementById('relatorioCPFCNPJ').textContent = document.getElementById('cpfcnpj').value;
            document.getElementById('relatorioNomeTomador').textContent = document.getElementById('nomeTomador').value;
            document.getElementById('relatorioEnderecoTomador').textContent = document.getElementById('enderecoTomador').value;
            document.getElementById('relatorioMunicipioTomador').textContent = document.getElementById('municipioTomador').value;

            // Preencher informações da nota
            document.getElementById('relatorioNumero').textContent = document.getElementById('numeroNota').textContent;
            document.getElementById('relatorioData').textContent = document.getElementById('dataHora').textContent;
            document.getElementById('relatorioVerificacao').textContent = document.getElementById('codigoVerificacao').textContent;

            // Calcular valor total (se campo3 contiver um valor numérico e campo2 contiver uma quantidade)
            const valorUnitario = parseFloat(document.getElementById('campo3').value.replace(/[^\d.,]/g, '').replace(',', '.')) || 0;
            const quantidade = parseFloat(document.getElementById('campo2').value) || 1;
            const total = valorUnitario * quantidade;
            document.getElementById('valorTotal').textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;

            // Exibir relatório
            const relatorio = document.getElementById('relatorio');
            relatorio.style.visibility = 'visible';
            relatorio.style.position = 'static';

            // Gerar PDF ou imprimir conforme solicitado
            if (pdf) html2pdf().from(relatorio).save();
            else if (print) window.print();
        }
    </script>
</body>

</html>